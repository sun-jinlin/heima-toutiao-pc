(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-934e0472"],{"0c12":function(e,r,t){"use strict";var a=t("2b0e");r["a"]=new a["default"]},"382c":function(e,r,t){},7424:function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"container-setting"},[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("my-bread",[e._v("个人设置")])],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form",{ref:"userForm",attrs:{"label-width":"120px",model:e.userForm,rules:e.userRules}},[t("el-form-item",{attrs:{label:"编号："}},[e._v(e._s(e.userForm.id))]),t("el-form-item",{attrs:{label:"手机号："}},[e._v(e._s(e.userForm.mobile))]),t("el-form-item",{attrs:{label:"媒体名称：",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入媒体名称"},model:{value:e.userForm.name,callback:function(r){e.$set(e.userForm,"name",r)},expression:"userForm.name"}})],1),t("el-form-item",{attrs:{label:"媒体介绍：",prop:"intro"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入媒体介绍"},model:{value:e.userForm.intro,callback:function(r){e.$set(e.userForm,"intro",r)},expression:"userForm.intro"}})],1),t("el-form-item",{attrs:{label:"邮箱：",prop:"email"}},[t("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.userForm.email,callback:function(r){e.$set(e.userForm,"email",r)},expression:"userForm.email"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.updateUserInfo}},[e._v("保存设置")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"http-request":e.changeFile}},[e.userForm.photo?t("img",{staticClass:"avatar",attrs:{src:e.userForm.photo}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("p",{staticClass:"text"},[e._v("修改头像")])],1)],1)],1)],1)},s=[],n=(t("b0c0"),t("96cf"),t("1da1")),o=t("0c12"),u=t("5f87"),i={name:"setting-page",data:function(){var e=function(e,r,t){if(!/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(r))return t(new Error("请输入正确的邮箱格式"));t()};return{userRules:{name:[{required:!0,message:"请填写媒体名称",trigger:"blur"},{min:1,max:7,message:"请填写1-7位字符串",trigger:"blur"}],intro:[{required:!0,message:"请填写媒体介绍",trigger:"blur"}],email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{validator:e,trigger:"blur"}]},userForm:{id:null,name:null,intro:null,email:null,photo:null,mobile:null}}},created:function(){this.getUserInfo()},methods:{changeFile:function(e){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,n,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.file,s=new FormData,s.append("photo",a),t.next=5,r.$http.patch("/user/photo",s);case 5:n=t.sent,i=n.data.data,r.$message.success("修改头像成功"),r.userForm.photo=i.photo,o["a"].$emit("update-user-photo",i.photo),l=u["a"].getUser(),l.photo=i.photo,u["a"].setUser(l);case 13:case"end":return t.stop()}}),t)})))()},updateUserInfo:function(){var e=this;this.$refs.userForm.validate(function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(t){var a,s,n,i,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=17;break}return r.prev=1,a=e.userForm,s=a.name,n=a.intro,i=a.email,r.next=5,e.$http.patch("/user/profile",{name:s,intro:n,email:i});case 5:e.$message.success("保存设置成功"),o["a"].$emit("update-user-name",s),l=u["a"].getUser(),l.name=s,u["a"].setUser(l),r.next=17;break;case 12:if(r.prev=12,r.t0=r["catch"](1),!r.t0.response||409!==r.t0.response.status){r.next=16;break}return r.abrupt("return",e.$message.error("媒体名称已存在"));case 16:e.$message.error("保存设置失败");case 17:case"end":return r.stop()}}),r,null,[[1,12]])})));return function(e){return r.apply(this,arguments)}}())},getUserInfo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$http.get("/user/profile");case 2:t=r.sent,a=t.data.data,e.userForm=a;case 5:case"end":return r.stop()}}),r)})))()}}},l=i,c=(t("cc2b"),t("2877")),m=Object(c["a"])(l,a,s,!1,null,"7bd22a88",null);r["default"]=m.exports},cc2b:function(e,r,t){"use strict";var a=t("382c"),s=t.n(a);s.a}}]);
//# sourceMappingURL=chunk-934e0472.e260dfeb.js.map