(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f889d10c"],{"94fa":function(e,t,a){},bf0c:function(e,t,a){"use strict";var s=a("94fa"),r=a.n(s);r.a},e036:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("my-bread",[e._v("素材管理")])],1),a("div",{staticClass:"btn-nav"},[a("el-radio-group",{attrs:{size:"small"},on:{change:e.changeCollect},model:{value:e.resParams.collect,callback:function(t){e.$set(e.resParams,"collect",t)},expression:"resParams.collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"small"},on:{click:e.openDialog}},[e._v("添加素材")])],1),a("div",{staticClass:"img-list"},e._l(e.images,(function(t){return a("div",{key:t.id,staticClass:"img-item"},[a("img",{attrs:{src:t.url,alt:""}}),a("div",{staticClass:"img-option"},[a("span",{staticClass:"el-icon-star-off",class:{red:t.is_collected},on:{click:function(a){return e.toggleStatus(t)}}}),a("span",{staticClass:"el-icon-delete",on:{click:function(a){return e.delImage(t)}}})])])})),0),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"current-page":e.resParams.page,"page-size":e.resParams.per_page,"hide-on-single-page":""},on:{"current-change":e.changePage}})],1),a("el-dialog",{attrs:{title:"添加素材",visible:e.dialogVisible,width:"300px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",name:"image",headers:e.headers,"show-file-list":!1,"on-success":e.uploadImageSuccess}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)},r=[],n=(a("96cf"),a("1da1")),i=a("5f87"),c={name:"image-page",data:function(){return{resParams:{collect:!1,page:1,per_page:10},images:[],total:0,dialogVisible:!1,imageUrl:"",headers:{Authorization:"Bearer ".concat(i["a"].getUser().token)}}},created:function(){this.getImages()},methods:{uploadImageSuccess:function(e){var t=this;this.$message.success("上传成功"),this.imageUrl=e.data.url,window.setTimeout((function(){t.dialogVisible=!1,t.getImages()}),3e3)},openDialog:function(){this.dialogVisible=!0},delImage:function(e){var t=this;this.$confirm("此操作将永久删除该图片, 是否继续?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.delete("/user/images/".concat(e.id));case 3:t.$message.success("删除图片成功"),t.getImages(),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$message.error("删除图片失败");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))).catch((function(){}))},toggleStatus:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.put("/user/images/".concat(e.id),{collect:!e.is_collected});case 3:s=a.sent,r=s.data.data,t.$message.success(e.is_collected?"取消收藏成功":"添加收藏成功"),e.is_collected=r.collect,a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),t.$message.error(e.is_collected?"取消收藏失败":"添加收藏失败");case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},getImages:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/user/images",{params:e.resParams});case 2:a=t.sent,s=a.data.data,e.images=s.results,e.total=s.total_count;case 6:case"end":return t.stop()}}),t)})))()},changeCollect:function(){this.resParams.page=1,this.getImages()},changePage:function(e){this.resParams.page=e,this.getImages()}}},l=c,o=(a("bf0c"),a("2877")),u=Object(o["a"])(l,s,r,!1,null,"563ad8ca",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-f889d10c.24c5edaf.js.map